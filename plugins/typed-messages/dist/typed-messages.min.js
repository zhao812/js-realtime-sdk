!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-storage"),require("leancloud-realtime")):"function"==typeof define&&define.amd?define("typed-messages",["exports","leancloud-storage","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV,a.AV)}(this,function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a.default:a}function e(a,b){return b={exports:{}},a(b,b.exports),b.exports}var f=e(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),g=e(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),h=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},i=function(a,b,c){if(h(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},j=function(a){return"object"==typeof a?null!==a:"function"==typeof a},k=function(a){if(!j(a))throw TypeError(a+" is not an object!");return a},l=function(a){try{return!!a()}catch(a){return!0}},m=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),n=f.document,o=j(n)&&j(n.createElement),p=function(a){return o?n.createElement(a):{}},q=!m&&!l(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),r=function(a,b){if(!j(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!j(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!j(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!j(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},s=Object.defineProperty,t=m?Object.defineProperty:function(a,b,c){if(k(a),b=r(b,!0),k(c),q)try{return s(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},u={f:t},v=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},w=m?function(a,b,c){return u.f(a,b,v(1,c))}:function(a,b,c){return a[b]=c,a},x=function(a,b,c){var d,e,h,j=a&x.F,k=a&x.G,l=a&x.S,m=a&x.P,n=a&x.B,o=a&x.W,p=k?g:g[b]||(g[b]={}),q=p.prototype,r=k?f:l?f[b]:(f[b]||{}).prototype;k&&(c=b);for(d in c)(e=!j&&r&&void 0!==r[d])&&d in p||(h=e?r[d]:c[d],p[d]=k&&"function"!=typeof r[d]?c[d]:n&&e?i(h,f):o&&r[d]==h?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(h):m&&"function"==typeof h?i(Function.call,h):h,m&&((p.virtual||(p.virtual={}))[d]=h,a&x.R&&q&&!q[d]&&w(q,d,h)))};x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128;var y=x,z={}.hasOwnProperty,A=function(a,b){return z.call(a,b)},B={}.toString,C=function(a){return B.call(a).slice(8,-1)},D=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==C(a)?a.split(""):Object(a)},E=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},F=function(a){return D(E(a))},G=Math.ceil,H=Math.floor,I=function(a){return isNaN(a=+a)?0:(a>0?H:G)(a)},J=Math.min,K=function(a){return a>0?J(I(a),9007199254740991):0},L=Math.max,M=Math.min,N=function(a,b){return a=I(a),a<0?L(a+b,0):M(a,b)},O=f["__core-js_shared__"]||(f["__core-js_shared__"]={}),P=function(a){return O[a]||(O[a]={})},Q=0,R=Math.random(),S=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++Q+R).toString(36))},T=P("keys"),U=function(a){return T[a]||(T[a]=S(a))},V=function(a){return function(b,c,d){var e,f=F(b),g=K(f.length),h=N(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),W=U("IE_PROTO"),X=function(a,b){var c,d=F(a),e=0,f=[];for(c in d)c!=W&&A(d,c)&&f.push(c);for(;b.length>e;)A(d,c=b[e++])&&(~V(f,c)||f.push(c));return f},Y="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Z=Object.keys||function(a){return X(a,Y)},$=Object.getOwnPropertySymbols,_={f:$},aa={}.propertyIsEnumerable,ba={f:aa},ca=function(a){return Object(E(a))},da=Object.assign,ea=!da||l(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=da({},a)[c]||Object.keys(da({},b)).join("")!=d})?function(a,b){for(var c=ca(a),d=arguments.length,e=1,f=_.f,g=ba.f;d>e;)for(var h,i=D(arguments[e++]),j=f?Z(i).concat(f(i)):Z(i),k=j.length,l=0;k>l;)g.call(i,h=j[l++])&&(c[h]=i[h]);return c}:da;y(y.S+y.F,"Object",{assign:ea});var fa=g.Object.assign,ga=e(function(a){a.exports={default:fa,__esModule:!0}}),ha=d(ga),ia=e(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),ja=d(ia);y(y.S+y.F*!m,"Object",{defineProperty:u.f});var ka=g.Object,la=function(a,b,c){return ka.defineProperty(a,b,c)},ma=e(function(a){a.exports={default:la,__esModule:!0}}),na=e(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(ma);b.default=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),(0,c.default)(a,e.key,e)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()}),oa=d(na),pa=w,qa={},ra=m?Object.defineProperties:function(a,b){k(a);for(var c,d=Z(b),e=d.length,f=0;e>f;)u.f(a,c=d[f++],b[c]);return a},sa=f.document&&document.documentElement,ta=U("IE_PROTO"),ua=function(){},va=function(){var a,b=p("iframe"),c=Y.length;for(b.style.display="none",sa.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),va=a.F;c--;)delete va.prototype[Y[c]];return va()},wa=Object.create||function(a,b){var c;return null!==a?(ua.prototype=k(a),c=new ua,ua.prototype=null,c[ta]=a):c=va(),void 0===b?c:ra(c,b)},xa=e(function(a){var b=P("wks"),c=f.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:S)("Symbol."+a))}).store=b}),ya=u.f,za=xa("toStringTag"),Aa=function(a,b,c){a&&!A(a=c?a:a.prototype,za)&&ya(a,za,{configurable:!0,value:b})},Ba={};w(Ba,xa("iterator"),function(){return this});var Ca=function(a,b,c){a.prototype=wa(Ba,{next:v(1,c)}),Aa(a,b+" Iterator")},Da=U("IE_PROTO"),Ea=Object.prototype,Fa=Object.getPrototypeOf||function(a){return a=ca(a),A(a,Da)?a[Da]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?Ea:null},Ga=xa("iterator"),Ha=!([].keys&&"next"in[].keys()),Ia=function(){return this},Ja=function(a,b,c,d,e,f,g){Ca(c,b,d);var h,i,j,k=function(a){if(!Ha&&a in o)return o[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},l=b+" Iterator",m="values"==e,n=!1,o=a.prototype,p=o[Ga]||o["@@iterator"]||e&&o[e],q=p||k(e),r=e?m?k("entries"):q:void 0,s="Array"==b?o.entries||p:p;if(s&&(j=Fa(s.call(new a)))!==Object.prototype&&Aa(j,l,!0),m&&p&&"values"!==p.name&&(n=!0,q=function(){return p.call(this)}),g&&(Ha||n||!o[Ga])&&w(o,Ga,q),qa[b]=q,qa[l]=Ia,e)if(h={values:m?q:k("values"),keys:f?q:k("keys"),entries:r},g)for(i in h)i in o||pa(o,i,h[i]);else y(y.P+y.F*(Ha||n),b,h);return h},Ka=function(a){return function(b,c){var d,e,f=String(E(b)),g=I(c),h=f.length;return g<0||g>=h?a?"":void 0:(d=f.charCodeAt(g),d<55296||d>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):d:a?f.slice(g,g+2):e-56320+(d-55296<<10)+65536)}}(!0);Ja(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=Ka(b,c),this._i+=a.length,{value:a,done:!1})});var La=function(a,b){return{value:b,done:!!a}};Ja(Array,"Array",function(a,b){this._t=F(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,La(1)):"keys"==b?La(0,c):"values"==b?La(0,a[c]):La(0,[c,a[c]])},"values");qa.Arguments=qa.Array;for(var Ma=xa("toStringTag"),Na=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],Oa=0;Oa<5;Oa++){var Pa=Na[Oa],Qa=f[Pa],Ra=Qa&&Qa.prototype;Ra&&!Ra[Ma]&&w(Ra,Ma,Pa),qa[Pa]=qa.Array}var Sa=xa,Ta={f:Sa},Ua=Ta.f("iterator"),Va=e(function(a){a.exports={default:Ua,__esModule:!0}}),Wa=e(function(a){var b=S("meta"),c=u.f,d=0,e=Object.isExtensible||function(){return!0},f=!l(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!j(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!A(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},i=function(a,c){if(!A(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},k=function(a){return f&&m.NEED&&e(a)&&!A(a,b)&&g(a),a},m=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:i,onFreeze:k}}),Xa=u.f,Ya=function(a){var b=g.Symbol||(g.Symbol={});"_"==a.charAt(0)||a in b||Xa(b,a,{value:Ta.f(a)})},Za=function(a,b){for(var c,d=F(a),e=Z(d),f=e.length,g=0;f>g;)if(d[c=e[g++]]===b)return c},$a=function(a){var b=Z(a),c=_.f;if(c)for(var d,e=c(a),f=ba.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},_a=Array.isArray||function(a){return"Array"==C(a)},ab=Y.concat("length","prototype"),bb=Object.getOwnPropertyNames||function(a){return X(a,ab)},cb={f:bb},db=cb.f,eb={}.toString,fb="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gb=function(a){try{return db(a)}catch(a){return fb.slice()}},hb=function(a){return fb&&"[object Window]"==eb.call(a)?gb(a):db(F(a))},ib={f:hb},jb=Object.getOwnPropertyDescriptor,kb=m?jb:function(a,b){if(a=F(a),b=r(b,!0),q)try{return jb(a,b)}catch(a){}if(A(a,b))return v(!ba.f.call(a,b),a[b])},lb={f:kb},mb=Wa.KEY,nb=lb.f,ob=u.f,pb=ib.f,qb=f.Symbol,rb=f.JSON,sb=rb&&rb.stringify,tb=xa("_hidden"),ub=xa("toPrimitive"),vb={}.propertyIsEnumerable,wb=P("symbol-registry"),xb=P("symbols"),yb=P("op-symbols"),zb=Object.prototype,Ab="function"==typeof qb,Bb=f.QObject,Cb=!Bb||!Bb.prototype||!Bb.prototype.findChild,Db=m&&l(function(){return 7!=wa(ob({},"a",{get:function(){return ob(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=nb(zb,b);d&&delete zb[b],ob(a,b,c),d&&a!==zb&&ob(zb,b,d)}:ob,Eb=function(a){var b=xb[a]=wa(qb.prototype);return b._k=a,b},Fb=Ab&&"symbol"==typeof qb.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof qb},Gb=function(a,b,c){return a===zb&&Gb(yb,b,c),k(a),b=r(b,!0),k(c),A(xb,b)?(c.enumerable?(A(a,tb)&&a[tb][b]&&(a[tb][b]=!1),c=wa(c,{enumerable:v(0,!1)})):(A(a,tb)||ob(a,tb,v(1,{})),a[tb][b]=!0),Db(a,b,c)):ob(a,b,c)},Hb=function(a,b){k(a);for(var c,d=$a(b=F(b)),e=0,f=d.length;f>e;)Gb(a,c=d[e++],b[c]);return a},Ib=function(a,b){return void 0===b?wa(a):Hb(wa(a),b)},Jb=function(a){var b=vb.call(this,a=r(a,!0));return!(this===zb&&A(xb,a)&&!A(yb,a))&&(!(b||!A(this,a)||!A(xb,a)||A(this,tb)&&this[tb][a])||b)},Kb=function(a,b){if(a=F(a),b=r(b,!0),a!==zb||!A(xb,b)||A(yb,b)){var c=nb(a,b);return!c||!A(xb,b)||A(a,tb)&&a[tb][b]||(c.enumerable=!0),c}},Lb=function(a){for(var b,c=pb(F(a)),d=[],e=0;c.length>e;)A(xb,b=c[e++])||b==tb||b==mb||d.push(b);return d},Mb=function(a){for(var b,c=a===zb,d=pb(c?yb:F(a)),e=[],f=0;d.length>f;)!A(xb,b=d[f++])||c&&!A(zb,b)||e.push(xb[b]);return e};Ab||(qb=function(){if(this instanceof qb)throw TypeError("Symbol is not a constructor!");var a=S(arguments.length>0?arguments[0]:void 0),b=function(c){this===zb&&b.call(yb,c),A(this,tb)&&A(this[tb],a)&&(this[tb][a]=!1),Db(this,a,v(1,c))};return m&&Cb&&Db(zb,a,{configurable:!0,set:b}),Eb(a)},pa(qb.prototype,"toString",function(){return this._k}),lb.f=Kb,u.f=Gb,cb.f=ib.f=Lb,ba.f=Jb,_.f=Mb,Ta.f=function(a){return Eb(xa(a))}),y(y.G+y.W+y.F*!Ab,{Symbol:qb});for(var Nb="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ob=0;Nb.length>Ob;)xa(Nb[Ob++]);for(var Nb=Z(xa.store),Ob=0;Nb.length>Ob;)Ya(Nb[Ob++]);y(y.S+y.F*!Ab,"Symbol",{for:function(a){return A(wb,a+="")?wb[a]:wb[a]=qb(a)},keyFor:function(a){if(Fb(a))return Za(wb,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){Cb=!0},useSimple:function(){Cb=!1}}),y(y.S+y.F*!Ab,"Object",{create:Ib,defineProperty:Gb,defineProperties:Hb,getOwnPropertyDescriptor:Kb,getOwnPropertyNames:Lb,getOwnPropertySymbols:Mb}),rb&&y(y.S+y.F*(!Ab||l(function(){var a=qb();return"[null]"!=sb([a])||"{}"!=sb({a:a})||"{}"!=sb(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!Fb(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&_a(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!Fb(b))return b}),d[1]=b,sb.apply(rb,d)}}}),qb.prototype[ub]||w(qb.prototype,ub,qb.prototype.valueOf),Aa(qb,"Symbol"),Aa(Math,"Math",!0),Aa(f.JSON,"JSON",!0),Ya("asyncIterator"),Ya("observable");var Pb=g.Symbol,Qb=e(function(a){a.exports={default:Pb,__esModule:!0}}),Rb=e(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(Va),e=c(Qb),f="function"==typeof e.default&&"symbol"==typeof d.default?function(a){return typeof a}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":typeof a};b.default="function"==typeof e.default&&"symbol"===f(d.default)?function(a){return void 0===a?"undefined":f(a)}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":void 0===a?"undefined":f(a)}}),Sb=e(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(Rb);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,c.default)(b))&&"function"!=typeof b?a:b}}),Tb=d(Sb),Ub=function(a,b){if(k(a),!j(b)&&null!==b)throw TypeError(b+": can't set as prototype!")},Vb={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=i(Function.call,lb.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,d){return Ub(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):void 0),check:Ub};y(y.S,"Object",{setPrototypeOf:Vb.set});var Wb=g.Object.setPrototypeOf,Xb=e(function(a){a.exports={default:Wb,__esModule:!0}});y(y.S,"Object",{create:wa});var Yb=g.Object,Zb=function(a,b){return Yb.create(a,b)},$b=e(function(a){a.exports={default:Zb,__esModule:!0}}),_b=e(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(Xb),e=c($b),f=c(Rb);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,f.default)(b)));a.prototype=(0,e.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(d.default?(0,d.default)(a,b):a.__proto__=b)}}),ac=d(_b);if(!b.File)throw new Error("LeanCloud Storage SDK not installed");if(!c.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var bc=function(a){function d(c){if(ja(this,d),!(c instanceof b.File))throw new TypeError("file must be an AV.File");if("string"!=typeof c.id)throw new Error("file must be saved before used to create a Message");var e=Tb(this,a.call(this));return e._file=c,e._lcfile={objId:c.id,url:c.url(),metaData:ha(c.metaData()||{},{name:c.name()})},e}return ac(d,a),d.prototype.getFile=function(){return this._file},d._parseFileFromRawData=function(a){if(!a||!a._lcfile)throw new Error("malformed FileMessage content");var c=a._lcfile.objId;"string"!=typeof c&&(c="");var d=b.File.createWithoutData(c);return d.attributes=d.attributes||{},d._url=d.attributes.url=a._lcfile.url,d._metaData=d.attributes.metaData=a._lcfile.metaData||{},a._lcfile.metaData&&(d._name=d.attributes.name=a._lcfile.metaData.name),d},d.parse=function(a,b){var d=this._parseFileFromRawData(a);return c.TypedMessage.parse(a,b||new this(d))},oa(d,[{key:"summary",get:function(){return("["+this.constructor._summaryType+"] "+(this._file.name()||"")).trim()}}]),d}(c.TypedMessage);bc._summaryType="文件",c.messageType(-6)(bc),c.messageField("_lcfile")(bc);var cc=function(a){function b(){return ja(this,b),Tb(this,a.apply(this,arguments))}return ac(b,a),b}(bc);cc._summaryType="图片",c.messageType(-2)(cc);var dc=function(a){function b(){return ja(this,b),Tb(this,a.apply(this,arguments))}return ac(b,a),b}(bc);dc._summaryType="语音",c.messageType(-3)(dc);var ec=function(a){function b(){return ja(this,b),Tb(this,a.apply(this,arguments))}return ac(b,a),b}(bc);ec._summaryType="视频",c.messageType(-4)(ec);var fc=function(a){function d(c){if(ja(this,d),!(c instanceof b.GeoPoint))throw new TypeError("geoPoint must be an AV.GeoPoint");var e=Tb(this,a.call(this));e._geoPoint=c;var f=c.latitude,g=c.longitude;return e._lcloc={latitude:f,longitude:g},e}return ac(d,a),d.prototype.getLocation=function(){return this._geoPoint},d.parse=function(a,d){var e=a._lcloc,f=e.latitude,g=e.longitude,h=new b.GeoPoint({latitude:f,longitude:g});return c.TypedMessage.parse(a,d||new this(h))},oa(d,[{key:"summary",get:function(){return("[位置] "+(this.text||"")).trim()}}]),d}(c.TypedMessage);c.messageType(-5)(fc),c.messageField("_lcloc")(fc);var gc={name:"leancloud-realtime-plugin-typed-messages",messageClasses:[bc,cc,dc,ec,fc]};a.TypedMessagesPlugin=gc,a.FileMessage=bc,a.ImageMessage=cc,a.AudioMessage=dc,a.VideoMessage=ec,a.LocationMessage=fc,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=typed-messages.min.js.map